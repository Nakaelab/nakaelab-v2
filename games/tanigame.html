<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>ä¸­æ±Ÿç ” å˜ä½ç²å¾—ã‚²ãƒ¼ãƒ  ğŸ“</title>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-user-select: none;
      user-select: none;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(180deg, #1a1a2e 0%, #16213e 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      overflow: hidden;
      touch-action: none;
    }

    .game-container {
      text-align: center;
      color: #fff;
      width: 100%;
      max-width: 500px;
      padding: 10px;
    }

    #gameCanvas {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(10px);
      border: 3px solid rgba(102, 126, 234, 0.3);
      touch-action: none;
      max-width: 100%;
      height: auto;
    }

    .score {
      font-size: 24px;
      font-weight: bold;
      margin-top: 10px;
      text-shadow: 0 2px 10px rgba(102, 126, 234, 0.8);
      color: #ffd700;
    }

    .lives {
      font-size: 20px;
      margin-top: 6px;
      color: #ff6b9d;
      font-weight: bold;
    }

    .teacher-counter {
      font-size: 22px;
      margin-top: 8px;
      color: #4ecdc4;
      font-weight: bold;
    }

    .futon-counter {
      font-size: 16px;
      margin-top: 6px;
      color: #ff9a76;
      font-weight: bold;
      min-height: 24px;
    }

    .instructions {
      margin-top: 10px;
      font-size: 13px;
      color: #c7ecee;
      font-weight: 600;
      line-height: 1.4;
      padding: 0 10px;
    }

    .back-button {
      position: fixed;
      top: 20px;
      left: 20px;
      background: rgba(102, 126, 234, 0.9);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-radius: 50px;
      padding: 12px 24px;
      color: #fff;
      text-decoration: none;
      font-size: 16px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s ease;
      z-index: 100;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    }

    .back-button:hover {
      background: rgba(102, 126, 234, 1);
      transform: translateX(-3px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
    }

    /* èª¬æ˜ç”»é¢ */
    .tutorial-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.95);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 2000;
      padding: 20px;
    }

    .tutorial-content {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 30px;
      border-radius: 20px;
      max-width: 500px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
    }

    .tutorial-content h1 {
      font-size: 28px;
      margin-bottom: 20px;
      color: #fff;
      text-align: center;
    }

    .tutorial-section {
      margin-bottom: 20px;
      background: rgba(255, 255, 255, 0.2);
      padding: 15px;
      border-radius: 10px;
    }

    .tutorial-section h2 {
      font-size: 20px;
      margin-bottom: 10px;
      color: #fff;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .tutorial-section p {
      font-size: 15px;
      line-height: 1.6;
      color: #fff;
      margin-bottom: 8px;
    }

    .tutorial-section .highlight {
      background: #ffd700;
      padding: 2px 6px;
      border-radius: 4px;
      font-weight: bold;
      color: #333;
    }

    .start-button {
      background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
      color: #333;
      border: none;
      padding: 18px 50px;
      font-size: 20px;
      font-weight: bold;
      border-radius: 50px;
      cursor: pointer;
      transition: transform 0.2s;
      width: 100%;
      margin-top: 10px;
      box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
    }

    .start-button:active {
      transform: scale(0.95);
    }

    /* ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼/ã‚¯ãƒªã‚¢ç”»é¢ */
    .game-over {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.95);
      padding: 30px 40px;
      border-radius: 20px;
      display: none;
      color: white;
      z-index: 1000;
      max-width: 90%;
      text-align: center;
    }

    .game-over h2 {
      font-size: 24px;
      margin-bottom: 15px;
      line-height: 1.3;
    }

    .game-over p {
      font-size: 20px;
      margin-bottom: 25px;
    }

    .game-over button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #fff;
      border: none;
      padding: 15px 40px;
      font-size: 18px;
      font-weight: bold;
      border-radius: 50px;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .game-over button:active {
      transform: scale(0.95);
    }

    .game-clear {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%) !important;
    }

    @media (max-width: 480px) {
      .tutorial-content {
        padding: 20px;
      }
      
      .tutorial-content h1 {
        font-size: 24px;
      }
      
      .tutorial-section h2 {
        font-size: 18px;
      }
      
      .tutorial-section p {
        font-size: 14px;
      }
      
      .score {
        font-size: 20px;
      }
      
      .lives, .teacher-counter {
        font-size: 18px;
      }
      
      .futon-counter {
        font-size: 14px;
      }
      
      .instructions {
        font-size: 11px;
      }
      
      .game-over h2 {
        font-size: 20px;
      }
      
      .game-over p {
        font-size: 18px;
      }
    }
  </style>
</head>
<body>
  <!-- æˆ»ã‚‹ãƒœã‚¿ãƒ³ -->
  <a href="index.html" class="back-button">
    <span>â†</span>
    <span>ã‚²ãƒ¼ãƒ ä¸€è¦§</span>
  </a>

  <!-- èª¬æ˜ç”»é¢ -->
  <div class="tutorial-screen" id="tutorialScreen">
    <div class="tutorial-content">
      <h1>ğŸ“ ä¸­æ±Ÿç ” å˜ä½ç²å¾—ã‚²ãƒ¼ãƒ  ğŸ“</h1>
      
      <div class="tutorial-section">
        <h2>ğŸ¯ ã‚²ãƒ¼ãƒ ã®ç›®çš„</h2>
        <p>ã‹ã”ğŸ§ºã‚’å‹•ã‹ã—ã¦å­¦ç¿’ã‚¢ã‚¤ãƒ†ãƒ ã‚’ã‚­ãƒ£ãƒƒãƒ!<br>
        <span class="highlight">å…ˆç”ŸğŸ‘¨â€ğŸ«ã‚’3äººé›†ã‚ãŸã‚‰å£é ­è©¦å•ã‚¯ãƒªã‚¢!</span></p>
      </div>
      
      <div class="tutorial-section">
        <h2>ğŸ“š å­¦ç¿’ã‚¢ã‚¤ãƒ†ãƒ (é›†ã‚ã‚‹)</h2>
        <p>ğŸ“šæœ¬(5ç‚¹) âœï¸é‰›ç­†(10ç‚¹) ğŸ“Šè«–æ–‡(15ç‚¹)</p>
        <p>ğŸ”¬å®Ÿé¨“å™¨å…·(20ç‚¹) â˜•ã‚³ãƒ¼ãƒ’ãƒ¼(25ç‚¹) ğŸ’»PC(30ç‚¹)</p>
        <p>â€»ã‚¢ã‚¤ãƒ†ãƒ ã‚’1ã¤ã§ã‚‚é€ƒã—ãŸã‚‰<span class="highlight">å³ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼</span></p>
      </div>
      
      <div class="tutorial-section">
        <h2>ğŸ’š ãƒ©ã‚¤ãƒ•ã‚·ã‚¹ãƒ†ãƒ </h2>
        <p>ãƒ©ã‚¤ãƒ•ã¯<span class="highlight">3ã¤</span>ã‚¹ã‚¿ãƒ¼ãƒˆ!<br>ãƒ©ã‚¤ãƒ•ãŒ0ã«ãªã£ãŸã‚‰ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼</p>
      </div>
      
      <div class="tutorial-section">
        <h2>ğŸ›ï¸ å¸ƒå›£ã«æ³¨æ„!</h2>
        <p><strong>å°å¸ƒå›£ğŸ›ï¸:</strong> <span class="highlight">3å›å½“ãŸã‚‹</span>ã¨ãƒ©ã‚¤ãƒ•-1<br>
        ã€Œç¡çœ ã®èª˜æƒ‘...ã€</p>
        <p><strong>å¤§å¸ƒå›£âš ï¸ğŸ›ï¸:</strong> <span class="highlight">1å›ã§</span>ãƒ©ã‚¤ãƒ•-1<br>
        ã€Œçˆ†ç¡ã—ã¦ã—ã¾ã£ãŸ!ã€</p>
      </div>
      
      <div class="tutorial-section">
        <h2>ğŸ‘¨â€ğŸ« å…ˆç”Ÿã‚’é›†ã‚ã‚ˆã†!</h2>
        <p><span class="highlight">å…ˆç”Ÿã‚’3äººé›†ã‚ãŸã‚‰ã‚²ãƒ¼ãƒ ã‚¯ãƒªã‚¢!</span><br>
        å£é ­è©¦å•é€šéã§ç„¡äº‹å’æ¥­ ğŸ“</p>
      </div>
      
      <div class="tutorial-section">
        <h2>ğŸ® æ“ä½œæ–¹æ³•</h2>
        <p><strong>ã‚¹ãƒãƒ›:</strong> ç”»é¢ã‚¿ãƒƒãƒã§ã‹ã”ã‚’ç§»å‹•</p>
        <p><strong>PC:</strong> â† â†’ ã‚­ãƒ¼ã§ç§»å‹•</p>
      </div>
      
      <button class="start-button" onclick="startGame()">ç ”ç©¶å®¤ç”Ÿæ´»ã‚¹ã‚¿ãƒ¼ãƒˆ! ğŸš€</button>
    </div>
  </div>

  <div class="game-container">
    <canvas id="gameCanvas" width="400" height="600"></canvas>
    <div class="score">ğŸ“š å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆ: <span id="score">0</span></div>
    <div class="lives">ğŸ’š ãƒ©ã‚¤ãƒ•: <span id="lives">3</span></div>
    <div class="teacher-counter">ğŸ‘¨â€ğŸ« å…ˆç”Ÿ: <span id="teachers">0</span>/3</div>
    <div class="futon-counter" id="futonCounter"></div>
    <div class="instructions">
      ğŸ›ï¸ å°å¸ƒå›£3å› / å¤§å¸ƒå›£âš ï¸1å›ã§ãƒ©ã‚¤ãƒ•-1<br>
      å…ˆç”Ÿ3äººã§å£é ­è©¦å•ã‚¯ãƒªã‚¢!
    </div>
  </div>

  <div class="game-over" id="gameOver">
    <h2 id="gameOverTitle">ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼!</h2>
    <p id="gameOverMessage"></p>
    <p>å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆ: <span id="finalScore">0</span></p>
    <button onclick="restartGame()">ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ ğŸ”„</button>
  </div>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    
    // ã‚²ãƒ¼ãƒ å¤‰æ•°
    let player = {
      x: canvas.width / 2 - 40,
      y: canvas.height - 40,
      width: 80,
      height: 30,
      speed: 8
    };
    
    let fallingObjects = [];
    let score = 0;
    let lives = 3;
    let teacherCount = 0;
    let smallFutonHits = 0;
    let gameActive = false;
    let keys = {};
    let touchActive = false;
    let touchX = 0;
    
    // å­¦ç¿’ã‚¢ã‚¤ãƒ†ãƒ ã®ç¨®é¡
    const studyItems = [
      { emoji: 'ğŸ“š', points: 5, rarity: 0.25, size: 35, speed: 1.5 },
      { emoji: 'âœï¸', points: 10, rarity: 0.20, size: 35, speed: 1.8 },
      { emoji: 'ğŸ“Š', points: 15, rarity: 0.18, size: 35, speed: 2.0 },
      { emoji: 'ğŸ”¬', points: 20, rarity: 0.12, size: 35, speed: 2.2 },
      { emoji: 'â˜•', points: 25, rarity: 0.08, size: 35, speed: 2.4 },
      { emoji: 'ğŸ’»', points: 30, rarity: 0.05, size: 38, speed: 2.6 }
    ];
    
    // ã‚¿ãƒƒãƒ/ãƒã‚¦ã‚¹æ“ä½œ
    function getTouchPos(e) {
      const rect = canvas.getBoundingClientRect();
      const touch = e.touches ? e.touches[0] : e;
      return touch.clientX - rect.left;
    }
    
    canvas.addEventListener('touchstart', (e) => {
      e.preventDefault();
      touchActive = true;
      touchX = getTouchPos(e);
    });
    
    canvas.addEventListener('touchmove', (e) => {
      e.preventDefault();
      if (touchActive) {
        touchX = getTouchPos(e);
      }
    });
    
    canvas.addEventListener('touchend', (e) => {
      e.preventDefault();
      touchActive = false;
    });
    
    canvas.addEventListener('mousedown', (e) => {
      touchActive = true;
      touchX = getTouchPos(e);
    });
    
    canvas.addEventListener('mousemove', (e) => {
      if (touchActive) {
        touchX = getTouchPos(e);
      }
    });
    
    canvas.addEventListener('mouseup', () => {
      touchActive = false;
    });
    
    // ã‚¢ã‚¤ãƒ†ãƒ ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«é¸ã¶
    function selectRandomItem() {
      const rand = Math.random();
      let cumulativeRarity = 0;
      
      for (const item of studyItems) {
        cumulativeRarity += item.rarity;
        if (rand <= cumulativeRarity) {
          return item;
        }
      }
      return studyItems[0];
    }
    
    // è½ã¡ã¦ãã‚‹ç‰©ä½“ã‚’ç”Ÿæˆ
    function createFallingObject() {
      const typeChance = Math.random();
      
      // å…ˆç”Ÿ(12%)
      if (typeChance < 0.12) {
        return {
          x: Math.random() * (canvas.width - 50) + 25,
          y: -50,
          size: 45,
          speed: 1.3 + Math.random() * 0.7,
          emoji: 'ğŸ‘¨â€ğŸ«',
          isTeacher: true,
          isFuton: false,
          isBigFuton: false,
          points: 0
        };
      }
      // å°å¸ƒå›£(10%)
      else if (typeChance < 0.22) {
        return {
          x: Math.random() * (canvas.width - 40) + 20,
          y: -40,
          size: 35,
          speed: 1.6 + Math.random() * 1,
          emoji: 'ğŸ›ï¸',
          isTeacher: false,
          isFuton: true,
          isBigFuton: false,
          points: 0
        };
      }
      // å¤§å¸ƒå›£(4%)
      else if (typeChance < 0.26) {
        return {
          x: Math.random() * (canvas.width - 55) + 27,
          y: -55,
          size: 55,
          speed: 1.0 + Math.random() * 0.8,
          emoji: 'ğŸ›ï¸',
          isTeacher: false,
          isFuton: true,
          isBigFuton: true,
          points: 0
        };
      }
      // å­¦ç¿’ã‚¢ã‚¤ãƒ†ãƒ 
      else {
        const item = selectRandomItem();
        return {
          x: Math.random() * (canvas.width - 40) + 20,
          y: -40,
          size: item.size,
          speed: item.speed + Math.random() * 0.5,
          emoji: item.emoji,
          isTeacher: false,
          isFuton: false,
          isBigFuton: false,
          points: item.points
        };
      }
    }
    
    // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼(ã‹ã”)ã‚’æç”»
    function drawPlayer() {
      ctx.font = '60px serif';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillText('ğŸ§º', player.x + player.width / 2, player.y + player.height / 2);
    }
    
    // è½ä¸‹ç‰©ã‚’æç”»
    function drawFallingObject(obj) {
      ctx.font = obj.size + 'px serif';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      
      if (obj.isFuton) {
        const wobble = Math.sin(Date.now() / 150) * 2;
        ctx.fillText(obj.emoji, obj.x + wobble, obj.y);
        
        if (obj.isBigFuton) {
          ctx.font = '16px serif';
          ctx.fillText('âš ï¸', obj.x + wobble, obj.y - 35);
        }
      } else if (obj.isTeacher) {
        ctx.fillText(obj.emoji, obj.x, obj.y);
        ctx.font = '14px Arial';
        ctx.fillStyle = '#4ecdc4';
        ctx.strokeStyle = '#000';
        ctx.lineWidth = 2;
        ctx.strokeText('é‡è¦!', obj.x, obj.y + 30);
        ctx.fillText('é‡è¦!', obj.x, obj.y + 30);
      } else {
        ctx.fillText(obj.emoji, obj.x, obj.y);
        
        if (obj.points >= 20) {
          ctx.font = '14px Arial';
          ctx.fillStyle = '#ffd700';
          ctx.strokeStyle = '#000';
          ctx.lineWidth = 2;
          ctx.strokeText('+' + obj.points, obj.x, obj.y + 30);
          ctx.fillText('+' + obj.points, obj.x, obj.y + 30);
        }
      }
    }
    
    // è¡çªåˆ¤å®š
    function checkCollision(obj) {
      return (
        obj.y + obj.size / 2 >= player.y &&
        obj.y - obj.size / 2 <= player.y + player.height &&
        obj.x + obj.size / 2 >= player.x &&
        obj.x - obj.size / 2 <= player.x + player.width
      );
    }
    
    // å¸ƒå›£ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼è¡¨ç¤ºæ›´æ–°
    function updateFutonCounter() {
      const counterElement = document.getElementById('futonCounter');
      if (smallFutonHits > 0) {
        counterElement.textContent = `âš ï¸ å°å¸ƒå›£ãƒ’ãƒƒãƒˆ: ${smallFutonHits}/3`;
      } else {
        counterElement.textContent = '';
      }
    }
    
    // ã‚²ãƒ¼ãƒ ãƒ«ãƒ¼ãƒ—
    function gameLoop() {
      if (!gameActive) return;
      
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      // ã‚¿ãƒƒãƒæ“ä½œ
      if (touchActive) {
        const targetX = touchX - player.width / 2;
        player.x = Math.max(0, Math.min(canvas.width - player.width, targetX));
      }
      
      // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œ
      if (keys['ArrowLeft'] && player.x > 0) {
        player.x -= player.speed;
      }
      if (keys['ArrowRight'] && player.x < canvas.width - player.width) {
        player.x += player.speed;
      }
      
      // è½ä¸‹ç‰©ã‚’ç”Ÿæˆ
      if (Math.random() < 0.022) {
        fallingObjects.push(createFallingObject());
      }
      
      // è½ä¸‹ç‰©ã‚’æ›´æ–°ãƒ»æç”»
      for (let i = fallingObjects.length - 1; i >= 0; i--) {
        const obj = fallingObjects[i];
        obj.y += obj.speed;
        
        if (checkCollision(obj)) {
          if (obj.isTeacher) {
            // å…ˆç”Ÿã‚’ã‚²ãƒƒãƒˆ
            teacherCount++;
            document.getElementById('teachers').textContent = teacherCount;
            
            if (teacherCount >= 3) {
              gameClear();
              return;
            }
          } else if (obj.isFuton) {
            // å¸ƒå›£
            if (obj.isBigFuton) {
              lives--;
              document.getElementById('lives').textContent = lives;
              
              if (lives <= 0) {
                endGame('bigFuton');
                return;
              }
            } else {
              smallFutonHits++;
              updateFutonCounter();
              
              if (smallFutonHits >= 3) {
                lives--;
                document.getElementById('lives').textContent = lives;
                smallFutonHits = 0;
                updateFutonCounter();
                
                if (lives <= 0) {
                  endGame('smallFuton');
                  return;
                }
              }
            }
          } else {
            // å­¦ç¿’ã‚¢ã‚¤ãƒ†ãƒ 
            score += obj.points;
            document.getElementById('score').textContent = score;
          }
          fallingObjects.splice(i, 1);
          continue;
        }
        
        if (obj.y > canvas.height + 50) {
          if (!obj.isFuton) {
            // ã‚¢ã‚¤ãƒ†ãƒ ã¾ãŸã¯å…ˆç”Ÿã‚’é€ƒã—ãŸ
            endGame('missed');
            return;
          }
          fallingObjects.splice(i, 1);
          continue;
        }
        
        drawFallingObject(obj);
      }
      
      drawPlayer();
      requestAnimationFrame(gameLoop);
    }
    
    // ã‚²ãƒ¼ãƒ ã‚¯ãƒªã‚¢
    function gameClear() {
      gameActive = false;
      document.getElementById('finalScore').textContent = score;
      document.getElementById('gameOverTitle').textContent = 'ğŸ“ å£é ­è©¦å•ã‚¯ãƒªã‚¢!';
      document.getElementById('gameOverMessage').textContent = 'ç„¡äº‹å’æ¥­ãŠã‚ã§ã¨ã†!!';
      
      const gameOverElement = document.getElementById('gameOver');
      gameOverElement.classList.add('game-clear');
      gameOverElement.style.display = 'block';
    }
    
    // ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼
    function endGame(reason) {
      gameActive = false;
      document.getElementById('finalScore').textContent = score;
      
      const gameOverElement = document.getElementById('gameOver');
      gameOverElement.classList.remove('game-clear');
      
      if (reason === 'bigFuton') {
        document.getElementById('gameOverTitle').textContent = 'ğŸ›ï¸ğŸ’¤ çˆ†ç¡ã—ã¦ã—ã¾ã£ãŸ!';
        document.getElementById('gameOverMessage').textContent = 'å¯éãã¦å˜ä½è½ã¨ã—ãŸ...ç•™å¹´ç¢ºå®š!';
      } else if (reason === 'smallFuton') {
        document.getElementById('gameOverTitle').textContent = 'ğŸ›ï¸ğŸ›ï¸ğŸ›ï¸ ç¡çœ ã®èª˜æƒ‘ã«è² ã‘ãŸ!';
        document.getElementById('gameOverMessage').textContent = 'å°å¸ƒå›£3å›ã§ãƒ©ã‚¤ãƒ•å°½ããŸ...ç•™å¹´!';
      } else {
        document.getElementById('gameOverTitle').textContent = 'ğŸ˜­ å‹‰å¼·ä¸è¶³!';
        document.getElementById('gameOverMessage').textContent = 'ã‚¢ã‚¤ãƒ†ãƒ ã‚’é€ƒã—ã¦å˜ä½å–ã‚Œãªã‹ã£ãŸ...';
      }
      
      gameOverElement.style.display = 'block';
    }
    
    // èª¬æ˜ç”»é¢ã‚’é–‰ã˜ã¦ã‚²ãƒ¼ãƒ é–‹å§‹
    function startGame() {
      document.getElementById('tutorialScreen').style.display = 'none';
      gameActive = true;
      gameLoop();
    }
    
    // ã‚²ãƒ¼ãƒ å†é–‹
    function restartGame() {
      score = 0;
      lives = 3;
      teacherCount = 0;
      smallFutonHits = 0;
      fallingObjects = [];
      gameActive = true;
      player.x = canvas.width / 2 - 40;
      document.getElementById('score').textContent = '0';
      document.getElementById('lives').textContent = '3';
      document.getElementById('teachers').textContent = '0';
      updateFutonCounter();
      document.getElementById('gameOver').style.display = 'none';
      gameLoop();
    }
    
    // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›
    document.addEventListener('keydown', (e) => {
      keys[e.key] = true;
    });
    
    document.addEventListener('keyup', (e) => {
      keys[e.key] = false;
    });
  </script>
</body>
</html>